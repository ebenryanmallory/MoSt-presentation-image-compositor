<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" href="css/style.css"> 
    </head>
    <body>
        <section>
            <div class="ex1">
                <div id="image-holder" class="parent">
                    <h3>Create a Presentation Composite Image</h3>
                    <p>Screenshot two images of a web page, and display them side-by-side.</p>
                    <img id="result-image" src="temp/result.png" />
                </div>
                <br><br><hr>
                <div class="parent absolute color-container">
                    <div class="color" style="background:plum" onclick="selectColor(this)" data-color="plum"></div>
                    <div class="color" style="background:rebeccapurple" onclick="selectColor(this)" data-color="rebeccapurple"></div>
                    <div class="color" style="background:sienna" onclick="selectColor(this)" data-color="sienna"></div>
                    <div class="color" style="background:#2a3c44" onclick="selectColor(this)" data-color="#2a3c44"></div>
                </div>
            </div>
        </section>

        <br><br><br><br><hr><br>

        <section class="ex1">
            <div class="container parent">
                <h4>Inspiration</h4>
                <img style="max-width:500px;" src="images/page.jpg" />
                <div class="attribution">
                    <p>Inspiration was taken from the brilliant
                        <a href="https://dribbble.com/mikekus" target="_blank">Mike Kus</a>
                    </p>
                </div>
            </div>
        </section>

        <script>

        const settings = {};
        settings['color'] = '#2a3c44';

        async function post() {
            const url = '/composite-image'
            const response = await fetch(url, {
                method: 'POST',
                mode: 'same-origin',
                headers: {
                    'Content-Type': 'application/json'
                    },
                body: JSON.stringify(settings)
            });
            return response.blob();
        }

        async function getImage() {
            let returnedImage = await post();
            let returnedImageBlob = await returnedImage;
            const returnedImageURL = URL.createObjectURL(returnedImageBlob)
            document.querySelector('img#result-image').remove();
            let updateImage = document.createElement('img');
            updateImage.src = "temp/result.png";
            updateImage.src = returnedImageURL;
            updateImage.id = "result-image";
            document.querySelector('div#image-holder').appendChild(updateImage)
        }

        function selectColor(color) {
            document.querySelectorAll('.border').forEach(border => border.classList.remove('border'));
            color.classList.add('border');
            let selectedColor = color.getAttribute('data-color');
            settings['color'] = selectedColor;
            getImage();
        }

        </script>
    </body>
</html>