<!DOCTYPE html>

<head>
    <link rel="stylesheet" href="css/style.css"> 
</head>

<section>
    <div class="ex1">
        <div id="image-holder" class="parent">
            <img id="result-image" src="temp/result.png" />
            <div class="parent overlay">
                <button onclick="getImage()">click me</button>
            </div>
        </div>
    </div>
</section>

<section class="ex1">
    <div class="container parent">
        <h4>Inspiration</h4>
        <img style="max-width:500px;" src="images/page.jpg" />
        <div class="attribution">
            <p>Inspiration was taken from the brilliant
                <a href="https://dribbble.com/mikekus" target="_blank">Mike Kus</a>
            </p>
        </div>
    </div>
</section>

<script>

const settings = {};
settings['color'] = '#2a3c44';

async function post() {
    const url = '/composite-image'
    const response = await fetch(url, {
        method: 'POST',
        mode: 'same-origin',
        headers: {
            'Content-Type': 'application/json'
            },
        body: JSON.stringify(settings)
    });
    return response.blob();
}

async function getImage() {
    let returnedImage = await post();
    let returnedImageBlob = await returnedImage;
    const returnedImageURL = URL.createObjectURL(returnedImageBlob)
    document.querySelector('img#result-image').remove();
    let updateImage = document.createElement('img');
    updateImage.src = "temp/result.png";
    updateImage.src = returnedImageURL;
    updateImage.id = "result-image";
    document.querySelector('div#image-holder').appendChild(updateImage)
}

</script>

</html>